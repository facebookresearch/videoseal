{
    "cmd": "/private/home/pfz/miniconda3/envs/img/bin/python train.py",
    "git": "git@github.com:fairinternal/videoseal.git",
    "preload": "MKL_THREADING_LAYER=GNU",
    "commit": "pfz/unet",
    "precmd": [],
    "params": {
        "image_dataset":            "sa-1b-full-resized",
        "video_dataset":            "none",
        "augmentation_config":      "configs/all_augs_v3.yaml",
        "embedder_config":          "configs/alotofunets.yaml",
        "hidden_size_multiplier":   [0.25, 0.5, 1],
        "embedder_model":           [
            "unet_tiny_yuv_quant", 
            "unet_yuv_quant_chans8_blocks4_dims11248", 
            "unet_yuv_quant_chans8_blocks8_dims11248", 
            "unet_yuv_quant_chans8_blocks4_dims11224", 
            "unet_yuv_quant_chans8_blocks8_dims11224", 
            "unet_yuv_quant_chans4_blocks8_dims11248", 
            "unet_yuv_quant_chans4_blocks4_dims11248"
        ],
        "extractor_model":          "convnext_tiny",
        "disc_start":               50,
        "disc_in_channels":         1,
        "img_size":                 256,
        "img_size_val":             256,
        "img_size_proc":            256,
        "iter_per_epoch":           1000,
        "epochs":                   601,
        "prop_img_vid":             1.0,
        "video_start":              2000,
        "finetune_detector_start":  2000,
        "videowam_step_size":       8,
        "iter_per_valid":           10,
        "workers":                  8,
        "batch_size":               16,
        "batch_size_eval":          16,
        "batch_size_video":         1,
        "batch_size_video_eval":    1,
        "full_eval_freq":           50,
        "eval_freq":                10,
        "saveimg_freq":             50,
        "num_augs":                 2,
        "optimizer":                "AdamW,lr=1e-4",
        "scheduler":                "CosineLRScheduler,lr_min=1e-6,t_initial=601,warmup_lr_init=1e-8,warmup_t=20",
        "seed":                     0,
        "perceptual_loss":          "yuv",
        "lambda_i":                 0.0,
        "lambda_d":                 0.2, 
        "lambda_det":               0.0,
        "lambda_dec":               1.0,
        "nbits":                    256,
        "scaling_i":                1.0,
        "attenuation":              {
            "jnd_1_1": {
                "scaling_w":                [1.0],
                "scaling_w_schedule":       "Cosine,scaling_min=0.2,start_epoch=200,epochs=300"
            }
        },
        "total_gnorm":              1.0,
        "balanced":                 false,
        "master_port":              "__SAMPLE__(10000, 20000)"
    },
    "machine": {
        "gres":             "gpu:8",
        "nodes":            "2",
        "tasks-per-node":   "8",
        "partition":        "learnfair",
        "cpus-per-task":    "10",
        "time":             4320,
        "mem-per-cpu":      "6G"
    },
    "meta": {
        "group": "",
        "name": "0311_vseal_tiny_sweep_disc",
        "dest-arg": "yes",
        "dest-name": "output_dir"
    }
}